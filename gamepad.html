<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>ZIM - Code Creativity</title>

		<!-- Welcome to ZIM at https://zimjs.com - Code Creativity!                              -->
		<!-- ZIM runs on the HTML Canvas powered by JavaScript and CreateJS https://createjs.com -->
		<!-- Founded by Inventor Dan Zen - http://danzen.com - Canadian New Media Award Winner   -->
		<!-- ZIM is free to use. You can donate to help improve ZIM at https://zimjs.com/donate  -->

		<script src="https://zimjs.org/cdn/1.2.4/createjs.js"></script>
		<script src="https://zimjs.org/cdn/10.8.0/zim.js"></script>
		<!-- use zimjs.com/distill for minified individual functions! -->

		<script>
			// SCALING OPTIONS
			// scaling can have values as follows with full being the default
			// "fit"	sets canvas and stage to dimensions and scales to fit inside window size
			// "outside"	sets canvas and stage to dimensions and scales to fit outside window size
			// "full"	sets stage to window size with no scaling
			// "tagID"	add canvas to HTML tag of ID - set to dimensions if provided - no scaling

			const scaling = 'fit' // this will resize to fit inside the screen dimensions
			const width = 1024
			const height = 768
			const color = light // ZIM colors like green, blue, pink, faint, clear, etc.
			const outerColor = dark // any HTML colors like "violet", "#333", etc. are fine to use

			const frame = new Frame(scaling, width, height, color, outerColor)
			frame.on('ready', () => {
				// ES6 Arrow Function - like function(){}
				zog('ready from ZIM Frame') // logs in console (F12 - choose console)

				const stage = frame.stage
				let stageW = frame.width
				let stageH = frame.height

				// see https://zimjs.com/learn.html for video and code tutorials
				// see https://zimjs.com/docs.html for documentation
				// see https://zimjs.com/bits.html for 64 Interactive Media techniques

				// put your code here (you can delete this sample code)

				const tile = new Tile({
					obj: new Circle({ min: 10, max: 20 }, [
						red,
						black,
						pink,
						pink,
						pink
					]),
					cols: 20,
					rows: 20,
					spacingH: 500,
					spacingV: 500
				})

				const world = new Container(tile.width, tile.height).center()
				tile.addTo(world)

				const heart = new Blob({
					color: '#cc0000',
					interactive: false,
					points: [
						[0, -40.7, 0, 0, -57.3, -76.6, 41.8, -80.3, 'mirror'],
						[100, 0, 0, 0, 23.7, -45.4, -23.7, 45.4, 'mirror'],
						[0, 100, 0, 0, 0, 0, 0, 0, 'mirror'],
						[-100, 0, 0, 0, 21.9, 48.2, -21.9, -48.2, 'mirror']
					]
				})
					.transformPoints('rotation', 90)
					.center(world)

				frame.follow(heart)

				const colors = [purple, pink, blue, green, yellow, orange, red]
				const colorSeries = series(colors)

				function makeStar() {
					// each particle calls this function - to randomize the colors
					let star = new Shape(-20, -20, 40, 40)
					star.graphics
						.f(shuffle(colors)[0])
						.dp(0, 0, 18, 6, rand(0.5, 0.8))
					return star.sca(2)
				}

				const emitter = new Emitter({
					obj: makeStar, // ZIM VEE value or PICK - lets you pass a function that will be evaluated later - with random colors
					random: {
						regX: { min: 0, max: 30 },
						rotation: { min: 0, max: 360 }
					}, // start at random rotations for star
					// num:2, // send two at once
					force: 10,
					gravity: 0,
					life: 1000,
					decayTime: 1000,
					animation: {
						props: { rotation: [-360, 360] },
						ease: 'linear',
						loop: true
					}, // rotate one way or the other
					startPaused: true // wait until the emitter is spurted when the ball contacts a pin
				}).loc(heart, null, stage, 0)

				// const emitter2 = new Emitter({
				//     startPaused:true,
				//     obj:new Circle(50, "#cc0000"),
				//     gravity:0,
				//     force:10,
				//     interval:30,
				//     decayTime:500,
				//     life:500,
				//     angle:180
				// }).loc(heart,null,stage,0);

				const controller = new MotionController({
					target: heart,
					type: 'gamestick',
					map: [
						[0, 2],
						[0, 2],
						[1, 3],
						[1, 3]
					],
					container: world,
					rotate: true,
					boundary: new Boundary(0, 0, tile.width, tile.height)
				})
				controller.on('startmoving', function() {
					emitter.pauseEmitter(false)
				})
				controller.on('stopmoving', function() {
					emitter.pauseEmitter(true)
				})

				Ticker.add(function() {
					emitter.loc(heart)
					emitter.angle = heart.rotation + 180
				})

				stage.update() // this is needed to show any changes
			}) // end of ready
		</script>

		<meta name="viewport" content="width=device-width, user-scalable=no" />
	</head>

	<body>
		<!-- canvas with id="myCanvas" is made by zim Frame -->
	</body>
</html>
